<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家系図アプリ - Kakaizu Neo</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🌳 家系図アプリ</h1>
            <p class="subtitle">家系図の作成・編集・表示</p>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="view">家系図表示</button>
            <button class="tab-btn" data-tab="edit">編集</button>
            <button class="tab-btn" data-tab="import">インポート/エクスポート</button>
        </nav>

        <!-- View Tab -->
        <div id="view-tab" class="tab-content active">
            <div class="controls">
                <div class="filter-section">
                    <label for="filter-name">フィルター:</label>
                    <input type="text" id="filter-name" placeholder="名前を入力...">
                    <button id="apply-filter">適用</button>
                    <button id="clear-filter">クリア</button>
                </div>
            </div>
            <div class="canvas-container">
                <canvas id="family-tree-canvas"></canvas>
            </div>
        </div>

        <!-- Edit Tab -->
        <div id="edit-tab" class="tab-content">
            <div class="edit-controls">
                <button id="add-person-btn" class="btn-primary">➕ 人物を追加</button>
                <button id="add-relationship-btn" class="btn-secondary">🔗 関係を追加</button>
            </div>

            <div class="section">
                <h2>人物一覧</h2>
                <div class="table-container">
                    <table id="persons-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>名前</th>
                                <th>性別</th>
                                <th>生年月日</th>
                                <th>没年月日</th>
                                <th>養子</th>
                                <th>備考</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="persons-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2>関係一覧</h2>
                <div class="table-container">
                    <table id="relationships-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>人物1</th>
                                <th>人物2</th>
                                <th>関係</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="relationships-tbody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Import/Export Tab -->
        <div id="import-tab" class="tab-content">
            <div class="section">
                <h2>📥 インポート</h2>
                <div class="import-section">
                    <h3>CSVインポート</h3>
                    <p class="help-text">形式: 名前,性別,生年月日,没年月日,養子,備考</p>
                    <textarea id="csv-input" placeholder="CSVデータを貼り付けてください..." rows="6"></textarea>
                    <button id="import-csv-btn" class="btn-primary">CSVをインポート</button>
                </div>

                <div class="import-section">
                    <h3>JSONインポート</h3>
                    <textarea id="json-input" placeholder="JSONデータを貼り付けてください..." rows="6"></textarea>
                    <button id="import-json-btn" class="btn-primary">JSONをインポート</button>
                </div>
            </div>

            <div class="section">
                <h2>📤 エクスポート</h2>
                <div class="export-section">
                    <button id="export-csv-btn" class="btn-secondary">CSVでエクスポート</button>
                    <button id="export-json-btn" class="btn-secondary">JSONでエクスポート</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for adding/editing person -->
    <div id="person-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-title">人物を追加</h2>
            <form id="person-form">
                <input type="hidden" id="person-id">
                <div class="form-group">
                    <label for="person-name">名前 *</label>
                    <input type="text" id="person-name" required>
                </div>
                <div class="form-group">
                    <label for="person-gender">性別</label>
                    <select id="person-gender">
                        <option value="">選択してください</option>
                        <option value="男性">男性</option>
                        <option value="女性">女性</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="person-birth">生年月日</label>
                    <input type="text" id="person-birth" placeholder="例: 1980年1月1日 または 1980">
                </div>
                <div class="form-group">
                    <label for="person-death">没年月日</label>
                    <input type="text" id="person-death" placeholder="例: 2020年12月31日 または 2020">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="person-adopted">
                        養子
                    </label>
                </div>
                <div class="form-group">
                    <label for="person-notes">備考</label>
                    <textarea id="person-notes" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">保存</button>
                    <button type="button" class="btn-cancel" id="cancel-person">キャンセル</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for adding relationship -->
    <div id="relationship-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>関係を追加</h2>
            <form id="relationship-form">
                <div class="form-group">
                    <label for="rel-person1">人物1</label>
                    <select id="rel-person1" required>
                        <option value="">選択してください</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="rel-person2">人物2</label>
                    <select id="rel-person2" required>
                        <option value="">選択してください</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="rel-type">関係</label>
                    <select id="rel-type" required>
                        <option value="">選択してください</option>
                        <option value="spouse">配偶者</option>
                        <option value="ex_spouse">前配偶者</option>
                        <option value="parent_child">親子</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">保存</button>
                    <button type="button" class="btn-cancel" id="cancel-relationship">キャンセル</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
